<a
  class="group block border border-white/10 bg-white/[0.02] shadow-panel transition hover:border-white/20 hover:bg-white/[0.035]"
  href="/<%= encodeURIComponent(collection.slug) %>/<%= encodeURIComponent(inscription.id) %>"
  data-testid="inscription-card"
  data-inscription-id="<%= inscription.id %>"
>
  <div class="relative aspect-square border-b border-white/10 bg-white/[0.02] <%= (order && (order.status === 'pending' || order.status === 'confirmed')) ? 'opacity-60 grayscale' : '' %>" data-controller="image">
    <div
      class="absolute inset-0 animate-pulse bg-gradient-to-br from-white/[0.03] via-white/[0.06] to-white/[0.02]"
      data-image-target="skeleton"
    ></div>
    <% if (order && order.status === 'pending') { %>
      <div class="absolute inset-0 flex items-center justify-center bg-black/20">
        <span class="button-spinner text-orange-400"></span>
      </div>
    <% } %>
    <% if (order && order.status === 'confirmed') { %>
      <div class="absolute inset-0 flex items-center justify-center bg-black/10">
        <span class="text-[12px] font-semibold tracking-[0.22em] text-emerald-200/80">SOLD</span>
      </div>
    <% } %>
    <% if (inscription.isImage) { %>
    <img
        src="<%= inscription.contentUrl %>"
        alt="<%= inscription.title %>"
      loading="lazy"
      decoding="async"
        style="image-rendering: pixelated"
      class="block h-full w-full object-cover opacity-0 transition-opacity duration-300"
      data-image-target="img"
      data-action="load->image#loaded error->image#error"
      data-testid="inscription-thumb"
    />
    <% } else { %>
      <iframe
        src="<%= inscription.previewUrl %>"
        class="block h-full w-full border-0 pointer-events-none opacity-0 transition-opacity duration-300"
        loading="lazy"
        allow="accelerometer; gyroscope"
        data-image-target="media"
        data-action="load->image#loaded error->image#error"
        data-testid="inscription-thumb"
      ></iframe>
    <% } %>
  </div>
  <div class="p-4">
    <div class="flex items-start justify-between gap-3">
      <div class="min-w-0 flex-1">
        <div class="flex w-full items-center justify-between gap-2 min-w-0" data-testid="inscription-title">
          <div class="min-w-0 truncate text-base font-semibold leading-snug tracking-tight text-content"><%= inscription.title %></div>
          <div class="shrink-0 flex items-center gap-2">
            <% if (order && order.status === 'pending') { %>
              <span class="button-spinner text-orange-400"></span>
            <% } %>
            <% if (order && order.status === 'confirmed') { %>
              <span class="text-[11px] font-semibold tracking-wide text-emerald-300">SOLD</span>
            <% } %>
          </div>
        </div>
        <div class="mt-2 font-mono text-xs text-orange-500" data-testid="inscription-price"><%= formatSats(collection.price_sats) %></div>
      </div>
    </div>
  </div>
</a>
